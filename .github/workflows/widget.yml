name: Status
run-name: Create build statuses for ${{ inputs.application-name }}

on:
  workflow_run:
    workflows: ["bundle"]
    branches:
      - dev
    types:
      - completed
  workflow_dispatch:
    inputs:
      application-name:
        description: "Application name"
        required: true
      application-category:
        description: "Application category"
        required: true

jobs:
  build_statuses:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Generate README widget file
        id: bundle
        shell: bash
        run: >
          python3 ${{ env.CATALOG_ROOT_PATH }}/tools/widget.py \
            ${{ inputs.application-name }} ${{ inputs.application-category }} ;

      - name: Commit README widget file
        uses: EndBug/add-and-commit@v9
        with:
          add: 'applications/${{ inputs.application-category }}/${{ inputs.application-name }}/README.md'
          author_name: Git Action
